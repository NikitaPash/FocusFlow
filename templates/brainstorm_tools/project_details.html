{% extends 'base/base.html' %}
{% load static %}

<head>
    <title>{% block title %}{{ project.title }} - Focus Flow{% endblock %}</title>
    <link href="{% static 'styles/style.css' %}" rel="stylesheet">
</head>

<body>
{% block content %}
    <div class="container mt-4">
        <div class="row justify-content-center text-center mb-4">
            <div class="col-12 col-md-8">
                <h1 class="display-5">{{ project.title }}</h1>
                <p class="lead text-muted">{{ project.description }}</p>
            </div>
        </div>
        <div class="row mb-4 justify-content-center">
            <div class="col-12 col-md-8">
                <div class="row row-cols-2 row-cols-md-3 g-2 justify-content-center">
                    <div class="col">
                        <button class="btn btn-outline-dark w-100 section-btn" id="overviewBtn"
                                onclick="showSection('overviewSection')">Overview
                        </button>
                    </div>
                    <div class="col">
                        <button class="btn btn-outline-dark w-100 section-btn" id="featureListBtn"
                                onclick="showSection('featureListSection')">Feature List
                        </button>
                    </div>
                    <div class="col">
                        <button class="btn btn-outline-dark w-100 section-btn" id="analyticsBtn"
                                onclick="showSection('analyticsSection')">Analytics
                        </button>
                    </div>
                    <div class="col">
                        <button class="btn btn-outline-dark w-100 section-btn" id="commentsBtn"
                                onclick="showSection('commentsSection')">Comments
                        </button>
                    </div>
                    <div class="col">
                        <button class="btn btn-outline-dark w-100 section-btn" id="creditsBtn"
                                onclick="showSection('creditsSection')">Credits
                        </button>
                    </div>
                </div>
            </div>
        </div>


        <div id="overviewSection" class="project-info-section">
            <h3 class="text-center">Overview</h3>
            <div id="overviewSectionCard" class="card shadow mb-5 rounded">
                <h3 class="text-center">{{ project.title }}</h3>
                <p>{{ project.description }}</p>
            </div>
        </div>

        <div id="featureListSection" class="project-info-section pt-0" style="display: none;">
            <h3 class="text-center">Features</h3>
            <div class="accordion" id="featuresAccordion">
                {% for feature in features %}
                    <div class="accordion-item">
                        <h2 class="accordion-header" id="heading{{ feature.id }}">
                            <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse"
                                    data-bs-target="#collapse{{ feature.id }}" aria-expanded="false"
                                    aria-controls="collapse{{ feature.id }}">
                                {{ feature.feature_name }}
                            </button>
                        </h2>
                        <div id="collapse{{ feature.id }}" class="accordion-collapse collapse"
                             aria-labelledby="heading{{ feature.id }}" data-bs-parent="#featuresAccordion">
                            <div class="accordion-body">
                                {% if subfeatures %}
                                    <ul class="list-group list-group-flush">
                                        {% for subfeature in subfeatures %}
                                            {% if subfeature.feature.id == feature.id %}
                                                <li class="list-group-item">
                                                    <h6>{{ subfeature.subfeature_name }}</h6>
                                                </li>
                                            {% endif %}
                                        {% endfor %}
                                    </ul>
                                {% else %}
                                    <p class="text-muted">No subfeatures available for this feature.</p>
                                {% endif %}
                            </div>
                        </div>
                    </div>
                {% empty %}
                    <p class="text-muted text-center">No features available for this project.</p>
                {% endfor %}
            </div>
        </div>

        <div id="analyticsSection" class="project-info-section" style="display: none;">
            <h3 class="text-center mb-4">Analytics</h3>
            <p class="text-muted text-center">Analytics will be available soon.</p>
        </div>

        <div id="commentsSection" class="project-info-section" style="display: none;">
            <h3 class="text-center mb-4">Comments</h3>
            <p class="text-muted text-center">Comments will be available soon.</p>
        </div>

        <div id="creditsSection" class="project-info-section" style="display: none;">
            <h3 class="text-center mb-4">Credits</h3>
            <p class="text-muted text-center">Credits will be available soon.</p>
        </div>

        <div class="row justify-content-end mt-4">
            <div class="col-auto">
                <a href="{% url 'view_projects' project.user.username %}" class="btn btn-secondary btn-lg">Back to
                    Project List</a>
            </div>
        </div>
    </div>
    <script src="{% static 'js/project_sections.js' %}"></script>
{% endblock %}
</body>
